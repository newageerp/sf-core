import React from "react";
import { SFSOpenEditModalWindowProps, SFSOpenEditWindowProps } from '@newageerp/v3.popups.mvc-popup';
import { useNaePopup } from "../v3/old-ui/OldPopupProvider";

interface Props {
  from: string;
  to: string;
  id: number;
  inPopup?: boolean;
  type?: string;
  onSaveCallback?: (el: any, backFunc: any) => void;
}

export default function useConvert(props: Props) {
  const { isPopup } = useNaePopup();

  const createOptions: any = {
    options: {
      convert: {
        schema: props.from,
        element: { id: props.id },
      },
    },
    type: props.type ? props.type : "main",
    inPopup: !!props.inPopup,
    onSaveCallback: props.onSaveCallback
  };

  const openLink = () => {

    if (isPopup || createOptions.inPopup) {
      SFSOpenEditModalWindowProps({
        id: "new",
        schema: props.to,
        options: { createOptions: createOptions.options },
        type: createOptions.type,
        onSaveCallback: createOptions.onSaveCallback,
      });
    } else {
      SFSOpenEditWindowProps({
        id: "new",
        schema: props.to,
        options: { createOptions: createOptions.options },
        type: createOptions.type,
      });
    }
  };
  return [openLink, createOptions, isPopup];
}
